#!/usr/bin/env node

var cluster = require('cluster')
var path = require('path')

var configFile = path.resolve(process.argv[2] || 'config.json')
var config = require(configFile)

if(cluster.isMaster && config.prefork){
  for(var i = 0 ; i < config.prefork ; i++)
    cluster.fork()
}
else{
  var Realtime = require('../')
  var realtime = new Realtime(config, configFile)
  realtime.listen()
}

/* vim: ft=javascript
*/
